{% extends 'base.html' %}
{% load static %}

{% block head %}

    <link rel="stylesheet" type="text/css" href="{% static 'css/map/reviewcreate.css' %}">

{% endblock %}


{% block content %}
    {% if user.is_authenticated %}
<div class="content">
        <form method="POST" enctype="multipart/form-data">
          {% csrf_token %}
          <div class = "form-container">
            <div class ="form">
              <div>
              <button type = "button" class="btn btn-default"> <a href = "{% url 'map:booth_review_list' id %}"> ì·¨ì†Œ </a></button>
              <button type="submit" class="save btn btn-secondary">ì „ì†¡</button>
              </div>
              <div class ='title'>
                <label>{{boothname}}</label>
              </div>
              <!-- ì˜¤ë¥˜í‘œì‹œ Start -->
              <div class="error">
              {% if form.errors %}
                  <div class="alert alert-danger" role="alert">
                  {% for field in form %}
                      {% if field.errors %}
                      <strong>{{ field.label }}</strong>
                      {{ field.errors }}
                      {% endif %}
                  {% endfor %}
                  
                  <!-- ë³„ì  ì„ íƒ ì˜ˆì™¸ì²˜ë¦¬ -->
                  {% for error in form.errors %}
                    {% if error == "Rate" %}
                    <strong>{{error}}</strong>
                    <ul class="errorlist"><li>í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.</li></ul>
                    {% endif %}
                  {% endfor %}
                  </div>
              {% endif %}
              </div>
               <!-- ì˜¤ë¥˜í‘œì‹œ end-->
              <div class = "content">
                <table class = "star">
                <tbody>
                  <tr>
                    <th>
                    </th>
                    <td>
                      <div class="new-star-rating">
                        <input type="radio" id="5-stars" name="rating" value="5"/>
                        <label for="5-stars" class="star">â˜…</label>
                        <input type="radio" id="4-stars" name="rating" value="4"/>
                        <label for="4-stars" class="star">â˜…</label>
                        <input type="radio" id="3-stars" name="rating" value="3"/>
                        <label for="3-stars" class="star">â˜…</label>
                        <input type="radio" id="2-stars" name="rating" value="2"/>
                        <label for="2-stars" class="star">â˜…</label>
                        <input type="radio" id="1-stars" name="rating" value="1"/>
                        <label for="1-stars" class="star">â˜…</label>
                      </div>
                    </td>
                  </tr>
                </tbody>
                </table>

                  <div class="tag">
                    <label>íƒœê·¸</label>
                    <select class="form-select" aria-label="Default select example" name="tag" style="width: 100%; height: 9rem;" multiple="multiple">
                      <option value="ì‹œì„¤ì´ ê¹¨ë—í•´ìš”">âœ¨ ì‹œì„¤ì´ ê¹¨ë—í•´ìš”</option>
                      <option value="ì†Œí’ˆì´ ë‹¤ì–‘í•´ìš”">ğŸ‰ ì†Œí’ˆì´ ë‹¤ì–‘í•´ìš”</option>
                      <option value="ë¶€ìŠ¤ê°€ ë§ì•„ìš”">ğŸ“¸ ë¶€ìŠ¤ê°€ ë§ì•„ìš”</option>
                      <option value="ê³ ë°ê¸°ê°€ ìˆì–´ìš”">ğŸ’‡ğŸ»â€ â€ê³ ë°ê¸°ê°€ ìˆì–´ìš”</option>
                      <option value="ë¡œë“œì ì´ì—ìš”">ğŸ›£ï¸ ë¡œë“œì ì´ì—ìš”</option>
                    </select>
                </div>

                <div class="color">
                  <label>ë°°ê²½ìƒ‰</label>
                  <select class="form-select" aria-label="Default select example" name="color" multiple="multiple" style="width: 100%; overflow: auto;">
                    <option value="í•‘í¬" class="colorbtn colorpink">â– </option>
                    <option value="í•˜ëŠ˜" class="colorbtn colorskyblue">â– </option>
                    <option value="ë…¸ë‘" class="colorbtn coloryellow">â– </option>
                    <option value="íšŒìƒ‰" class="colorbtn colorgray">â– </option>
                    <option value="ë‚¨ìƒ‰" class="colorbtn colorindigo">â– </option>
                    <option value="ì—°ë‘" class="colorbtn colorgreen">â– </option>
                    <option value="ë³´ë¼" class="colorbtn colorpurple">â– </option>
                    <option value="ë¹¨ê°•" class="colorbtn colorred">â– </option>
                    <option value="ì£¼í™©" class="colorbtn colororange">â– </option>
                    <option value="ê¸°íƒ€">â– </option>
                    </select>
                </div>

                <div class = "textcontent">
                  <textarea class="content-input" placeholder="add comment here!" name="content">{% if review.content %}{{review.content}}{% endif %}</textarea>
                </div>

                <div>

                  <label class="img-btn" for="img-input"> ì‚¬ì§„ ì¶”ê°€ </label>
                  <input id="img-input" type="file" maxlength="255" name="img" value="{% if review.img %}{{review.img.url}}{% endif %}">

                </div>
              </div>
            </div>
          </div>
        </form>

        {% if review.rate %} <!-- update ì¸ ê²½ìš° -->

        <div id="original_data" class="d-none">
          <div id="original_rate">{{review.rate}}</div>
          <div id="original_tag">
            {% for tag in review.tag %}
              <div id="tag-{{forloop.counter0}}">{{tag}}</div>
            {% endfor %}
          </div>
          <div id="original_color">
            {% for color in review.color %}
              <div id="color-{{forloop.counter0}}">{{color}}</div>
            {% endfor %}
          </div>
        </div>
        
        
        <script type="text/javascript">
    
            const oristar = document.getElementById("original_rate").innerHTML
            document.getElementById(`${oristar}-stars`).checked = true
            
            const oritags = document.getElementById("original_tag")
            for (let tag of oritags.children) {
              tag = tag.innerHTML
              let findtag = document.querySelector(`option[value="${tag}"]`)
              findtag.selected = true
            }
            
            const oricolors = document.getElementById("original_color")
            for (let color of oricolors.children) {
              color = color.innerHTML
              let findcolor = document.querySelector(`option[value="${color}"]`)
              findcolor.selected = true
            }          
          
          </script>
        {% endif %}
        
      {% else %}
      <script type="text/javascript">
        alert('ë¡œê·¸ì¸ì„ ë¨¼ì € í•´ì£¼ì„¸ìš”.!')
        window.location.href = '{% url "user:login" %}'
      </script>
    {% endif %}
</div>
{% endblock %}
